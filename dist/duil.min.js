/** duil v0.3.2 | @copyright 2018 Metaist LLC <metaist.com> | @license MIT */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("jquery")):"function"==typeof define&&define.amd?define(["exports","jquery"],e):e(t.duil={},t.$)}(this,function(t,e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var r=Array.isArray,n="object"==typeof global&&global&&global.Object===Object&&global,o="object"==typeof self&&self&&self.Object===Object&&self,i=n||o||Function("return this")(),u=i.Symbol,a=Object.prototype,s=a.hasOwnProperty,c=a.toString,f=u?u.toStringTag:void 0;var l=Object.prototype.toString;var h="[object Null]",p="[object Undefined]",v=u?u.toStringTag:void 0;function d(t){return null==t?void 0===t?p:h:v&&v in Object(t)?function(t){var e=s.call(t,f),r=t[f];try{t[f]=void 0;var n=!0}catch(t){}var o=c.call(t);return n&&(e?t[f]=r:delete t[f]),o}(t):function(t){return l.call(t)}(t)}function b(t){return null!=t&&"object"==typeof t}var y="[object Symbol]";function g(t){return"symbol"==typeof t||b(t)&&d(t)==y}var _=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,j=/^\w*$/;function m(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var O="[object AsyncFunction]",w="[object Function]",A="[object GeneratorFunction]",E="[object Proxy]";function k(t){if(!m(t))return!1;var e=d(t);return e==w||e==A||e==O||e==E}var x,z=i["__core-js_shared__"],S=(x=/[^.]+$/.exec(z&&z.keys&&z.keys.IE_PROTO||""))?"Symbol(src)_1."+x:"";var q=Function.prototype.toString;function P(t){if(null!=t){try{return q.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var $=/^\[object .+?Constructor\]$/,C=Function.prototype,M=Object.prototype,T=C.toString,F=M.hasOwnProperty,W=RegExp("^"+T.call(F).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function D(t){return!(!m(t)||S&&S in t)&&(k(t)?W:$).test(P(t))}function R(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return D(r)?r:void 0}var B=R(Object,"create");var I="__lodash_hash_undefined__",N=Object.prototype.hasOwnProperty;var U=Object.prototype.hasOwnProperty;var L="__lodash_hash_undefined__";function G(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function V(t,e){return t===e||t!=t&&e!=e}function Y(t,e){for(var r=t.length;r--;)if(V(t[r][0],e))return r;return-1}G.prototype.clear=function(){this.__data__=B?B(null):{},this.size=0},G.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},G.prototype.get=function(t){var e=this.__data__;if(B){var r=e[t];return r===I?void 0:r}return N.call(e,t)?e[t]:void 0},G.prototype.has=function(t){var e=this.__data__;return B?void 0!==e[t]:U.call(e,t)},G.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=B&&void 0===e?L:e,this};var K=Array.prototype.splice;function Q(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Q.prototype.clear=function(){this.__data__=[],this.size=0},Q.prototype.delete=function(t){var e=this.__data__,r=Y(e,t);return!(r<0||(r==e.length-1?e.pop():K.call(e,r,1),--this.size,0))},Q.prototype.get=function(t){var e=this.__data__,r=Y(e,t);return r<0?void 0:e[r][1]},Q.prototype.has=function(t){return Y(this.__data__,t)>-1},Q.prototype.set=function(t,e){var r=this.__data__,n=Y(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var Z=R(i,"Map");function H(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function J(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}J.prototype.clear=function(){this.size=0,this.__data__={hash:new G,map:new(Z||Q),string:new G}},J.prototype.delete=function(t){var e=H(this,t).delete(t);return this.size-=e?1:0,e},J.prototype.get=function(t){return H(this,t).get(t)},J.prototype.has=function(t){return H(this,t).has(t)},J.prototype.set=function(t,e){var r=H(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};var X="Expected a function";function tt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(X);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var u=t.apply(this,n);return r.cache=i.set(o,u)||i,u};return r.cache=new(tt.Cache||J),r}tt.Cache=J;var et=500;var rt,nt,ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,it=/\\(\\)?/g,ut=(rt=tt(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(ot,function(t,r,n,o){e.push(n?o.replace(it,"$1"):r||t)}),e},function(t){return nt.size===et&&nt.clear(),t}),nt=rt.cache,rt);var at=1/0,st=u?u.prototype:void 0,ct=st?st.toString:void 0;function ft(t){if("string"==typeof t)return t;if(r(t))return function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}(t,ft)+"";if(g(t))return ct?ct.call(t):"";var e=t+"";return"0"==e&&1/t==-at?"-0":e}function lt(t,e){return r(t)?t:function(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!g(t))||j.test(t)||!_.test(t)||null!=e&&t in Object(e)}(t,e)?[t]:ut(function(t){return null==t?"":ft(t)}(t))}var ht=1/0;function pt(t){if("string"==typeof t||g(t))return t;var e=t+"";return"0"==e&&1/t==-ht?"-0":e}function vt(t,e,r){var n=null==t?void 0:function(t,e){for(var r=0,n=(e=lt(e,t)).length;null!=t&&r<n;)t=t[pt(e[r++])];return r&&r==n?t:void 0}(t,e);return void 0===n?r:n}var dt="[object Boolean]";var bt="[object Date]";function yt(t){return function(e){return t(e)}}var gt="object"==typeof t&&t&&!t.nodeType&&t,_t=gt&&"object"==typeof module&&module&&!module.nodeType&&module,jt=_t&&_t.exports===gt&&n.process,mt=function(){try{var t=_t&&_t.require&&_t.require("util").types;return t||jt&&jt.binding&&jt.binding("util")}catch(t){}}(),Ot=mt&&mt.isDate,wt=Ot?yt(Ot):function(t){return b(t)&&d(t)==bt};function At(t,e){return function(r){return t(e(r))}}var Et=At(Object.getPrototypeOf,Object),kt="[object Object]",xt=Function.prototype,zt=Object.prototype,St=xt.toString,qt=zt.hasOwnProperty,Pt=St.call(Object);function $t(t){if(!b(t)||d(t)!=kt)return!1;var e=Et(t);if(null===e)return!0;var r=qt.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&St.call(r)==Pt}function Ct(t){return b(t)&&1===t.nodeType&&!$t(t)}var Mt=Object.prototype;function Tt(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Mt)}var Ft=At(Object.keys,Object),Wt=Object.prototype.hasOwnProperty;function Dt(t){if(!Tt(t))return Ft(t);var e=[];for(var r in Object(t))Wt.call(t,r)&&"constructor"!=r&&e.push(r);return e}var Rt=R(i,"DataView"),Bt=R(i,"Promise"),It=R(i,"Set"),Nt=R(i,"WeakMap"),Ut=P(Rt),Lt=P(Z),Gt=P(Bt),Vt=P(It),Yt=P(Nt),Kt=d;(Rt&&"[object DataView]"!=Kt(new Rt(new ArrayBuffer(1)))||Z&&"[object Map]"!=Kt(new Z)||Bt&&"[object Promise]"!=Kt(Bt.resolve())||It&&"[object Set]"!=Kt(new It)||Nt&&"[object WeakMap]"!=Kt(new Nt))&&(Kt=function(t){var e=d(t),r="[object Object]"==e?t.constructor:void 0,n=r?P(r):"";if(n)switch(n){case Ut:return"[object DataView]";case Lt:return"[object Map]";case Gt:return"[object Promise]";case Vt:return"[object Set]";case Yt:return"[object WeakMap]"}return e});var Qt=Kt,Zt="[object Arguments]";function Ht(t){return b(t)&&d(t)==Zt}var Jt=Object.prototype,Xt=Jt.hasOwnProperty,te=Jt.propertyIsEnumerable,ee=Ht(function(){return arguments}())?Ht:function(t){return b(t)&&Xt.call(t,"callee")&&!te.call(t,"callee")},re=9007199254740991;function ne(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=re}function oe(t){return null!=t&&ne(t.length)&&!k(t)}var ie="object"==typeof t&&t&&!t.nodeType&&t,ue=ie&&"object"==typeof module&&module&&!module.nodeType&&module,ae=ue&&ue.exports===ie?i.Buffer:void 0,se=(ae?ae.isBuffer:void 0)||function(){return!1},ce={};ce["[object Float32Array]"]=ce["[object Float64Array]"]=ce["[object Int8Array]"]=ce["[object Int16Array]"]=ce["[object Int32Array]"]=ce["[object Uint8Array]"]=ce["[object Uint8ClampedArray]"]=ce["[object Uint16Array]"]=ce["[object Uint32Array]"]=!0,ce["[object Arguments]"]=ce["[object Array]"]=ce["[object ArrayBuffer]"]=ce["[object Boolean]"]=ce["[object DataView]"]=ce["[object Date]"]=ce["[object Error]"]=ce["[object Function]"]=ce["[object Map]"]=ce["[object Number]"]=ce["[object Object]"]=ce["[object RegExp]"]=ce["[object Set]"]=ce["[object String]"]=ce["[object WeakMap]"]=!1;var fe=mt&&mt.isTypedArray,le=fe?yt(fe):function(t){return b(t)&&ne(t.length)&&!!ce[d(t)]},he="[object Map]",pe="[object Set]",ve=Object.prototype.hasOwnProperty;function de(t){if(null==t)return!0;if(oe(t)&&(r(t)||"string"==typeof t||"function"==typeof t.splice||se(t)||le(t)||ee(t)))return!t.length;var e=Qt(t);if(e==he||e==pe)return!t.size;if(Tt(t))return!Dt(t).length;for(var n in t)if(ve.call(t,n))return!1;return!0}var be=200;function ye(t){var e=this.__data__=new Q(t);this.size=e.size}ye.prototype.clear=function(){this.__data__=new Q,this.size=0},ye.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},ye.prototype.get=function(t){return this.__data__.get(t)},ye.prototype.has=function(t){return this.__data__.has(t)},ye.prototype.set=function(t,e){var r=this.__data__;if(r instanceof Q){var n=r.__data__;if(!Z||n.length<be-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new J(n)}return r.set(t,e),this.size=r.size,this};var ge="__lodash_hash_undefined__";function _e(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new J;++e<r;)this.add(t[e])}function je(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}_e.prototype.add=_e.prototype.push=function(t){return this.__data__.set(t,ge),this},_e.prototype.has=function(t){return this.__data__.has(t)};var me=1,Oe=2;function we(t,e,r,n,o,i){var u=r&me,a=t.length,s=e.length;if(a!=s&&!(u&&s>a))return!1;var c=i.get(t);if(c&&i.get(e))return c==e;var f=-1,l=!0,h=r&Oe?new _e:void 0;for(i.set(t,e),i.set(e,t);++f<a;){var p=t[f],v=e[f];if(n)var d=u?n(v,p,f,e,t,i):n(p,v,f,t,e,i);if(void 0!==d){if(d)continue;l=!1;break}if(h){if(!je(e,function(t,e){if(u=e,!h.has(u)&&(p===t||o(p,t,r,n,i)))return h.push(e);var u})){l=!1;break}}else if(p!==v&&!o(p,v,r,n,i)){l=!1;break}}return i.delete(t),i.delete(e),l}var Ae=i.Uint8Array;function Ee(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}function ke(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var xe=1,ze=2,Se="[object Boolean]",qe="[object Date]",Pe="[object Error]",$e="[object Map]",Ce="[object Number]",Me="[object RegExp]",Te="[object Set]",Fe="[object String]",We="[object Symbol]",De="[object ArrayBuffer]",Re="[object DataView]",Be=u?u.prototype:void 0,Ie=Be?Be.valueOf:void 0;var Ne=Object.prototype.propertyIsEnumerable,Ue=Object.getOwnPropertySymbols,Le=Ue?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var u=t[r];e(u,r,t)&&(i[o++]=u)}return i}(Ue(t),function(e){return Ne.call(t,e)}))}:function(){return[]};var Ge=9007199254740991,Ve=/^(?:0|[1-9]\d*)$/;function Ye(t,e){var r=typeof t;return!!(e=null==e?Ge:e)&&("number"==r||"symbol"!=r&&Ve.test(t))&&t>-1&&t%1==0&&t<e}var Ke=Object.prototype.hasOwnProperty;function Qe(t,e){var n=r(t),o=!n&&ee(t),i=!n&&!o&&se(t),u=!n&&!o&&!i&&le(t),a=n||o||i||u,s=a?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],c=s.length;for(var f in t)!e&&!Ke.call(t,f)||a&&("length"==f||i&&("offset"==f||"parent"==f)||u&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||Ye(f,c))||s.push(f);return s}function Ze(t){return oe(t)?Qe(t):Dt(t)}function He(t){return function(t,e,n){var o=e(t);return r(t)?o:function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}(o,n(t))}(t,Ze,Le)}var Je=1,Xe=Object.prototype.hasOwnProperty;var tr=1,er="[object Arguments]",rr="[object Array]",nr="[object Object]",or=Object.prototype.hasOwnProperty;function ir(t,e,n,o,i,u){var a=r(t),s=r(e),c=a?rr:Qt(t),f=s?rr:Qt(e),l=(c=c==er?nr:c)==nr,h=(f=f==er?nr:f)==nr,p=c==f;if(p&&se(t)){if(!se(e))return!1;a=!0,l=!1}if(p&&!l)return u||(u=new ye),a||le(t)?we(t,e,n,o,i,u):function(t,e,r,n,o,i,u){switch(r){case Re:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case De:return!(t.byteLength!=e.byteLength||!i(new Ae(t),new Ae(e)));case Se:case qe:case Ce:return V(+t,+e);case Pe:return t.name==e.name&&t.message==e.message;case Me:case Fe:return t==e+"";case $e:var a=Ee;case Te:var s=n&xe;if(a||(a=ke),t.size!=e.size&&!s)return!1;var c=u.get(t);if(c)return c==e;n|=ze,u.set(t,e);var f=we(a(t),a(e),n,o,i,u);return u.delete(t),f;case We:if(Ie)return Ie.call(t)==Ie.call(e)}return!1}(t,e,c,n,o,i,u);if(!(n&tr)){var v=l&&or.call(t,"__wrapped__"),d=h&&or.call(e,"__wrapped__");if(v||d){var b=v?t.value():t,y=d?e.value():e;return u||(u=new ye),i(b,y,n,o,u)}}return!!p&&(u||(u=new ye),function(t,e,r,n,o,i){var u=r&Je,a=He(t),s=a.length;if(s!=He(e).length&&!u)return!1;for(var c=s;c--;){var f=a[c];if(!(u?f in e:Xe.call(e,f)))return!1}var l=i.get(t);if(l&&i.get(e))return l==e;var h=!0;i.set(t,e),i.set(e,t);for(var p=u;++c<s;){var v=t[f=a[c]],d=e[f];if(n)var b=u?n(d,v,f,e,t,i):n(v,d,f,t,e,i);if(!(void 0===b?v===d||o(v,d,r,n,i):b)){h=!1;break}p||(p="constructor"==f)}if(h&&!p){var y=t.constructor,g=e.constructor;y!=g&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof g&&g instanceof g)&&(h=!1)}return i.delete(t),i.delete(e),h}(t,e,n,o,i,u))}function ur(t,e,r,n,o){return t===e||(null==t||null==e||!b(t)&&!b(e)?t!=t&&e!=e:ir(t,e,r,n,ur,o))}function ar(t,e){return ur(t,e)}var sr="[object Number]";var cr="[object RegExp]";var fr=mt&&mt.isRegExp,lr=fr?yt(fr):function(t){return b(t)&&d(t)==cr},hr="[object String]";function pr(t){return t}var vr,dr=function(t,e,r){for(var n=-1,o=Object(t),i=r(t),u=i.length;u--;){var a=i[vr?u:++n];if(!1===e(o[a],a,o))break}return t},br=function(){try{var t=R(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();function yr(t,e,r){"__proto__"==e&&br?br(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function gr(t,e,r){(void 0===r||V(t[e],r))&&(void 0!==r||e in t)||yr(t,e,r)}var _r="object"==typeof t&&t&&!t.nodeType&&t,jr=_r&&"object"==typeof module&&module&&!module.nodeType&&module,mr=jr&&jr.exports===_r?i.Buffer:void 0,Or=mr?mr.allocUnsafe:void 0;function wr(t,e){var r,n,o=e?(r=t.buffer,n=new r.constructor(r.byteLength),new Ae(n).set(new Ae(r)),n):t.buffer;return new t.constructor(o,t.byteOffset,t.length)}var Ar=Object.create,Er=function(){function t(){}return function(e){if(!m(e))return{};if(Ar)return Ar(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();function kr(t,e){return"__proto__"==e?void 0:t[e]}var xr=Object.prototype.hasOwnProperty;function zr(t,e,r){var n=t[e];xr.call(t,e)&&V(n,r)&&(void 0!==r||e in t)||yr(t,e,r)}var Sr=Object.prototype.hasOwnProperty;function qr(t){if(!m(t))return function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}(t);var e=Tt(t),r=[];for(var n in t)("constructor"!=n||!e&&Sr.call(t,n))&&r.push(n);return r}function Pr(t){return oe(t)?Qe(t,!0):qr(t)}function $r(t){return function(t,e,r,n){var o=!r;r||(r={});for(var i=-1,u=e.length;++i<u;){var a=e[i],s=n?n(r[a],t[a],a,r,t):void 0;void 0===s&&(s=t[a]),o?yr(r,a,s):zr(r,a,s)}return r}(t,Pr(t))}function Cr(t,e,n,o,i,u,a){var s=kr(t,n),c=kr(e,n),f=a.get(c);if(f)gr(t,n,f);else{var l,h=u?u(s,c,n+"",t,e,a):void 0,p=void 0===h;if(p){var v=r(c),d=!v&&se(c),y=!v&&!d&&le(c);h=c,v||d||y?r(s)?h=s:b(l=s)&&oe(l)?h=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}(s):d?(p=!1,h=function(t,e){if(e)return t.slice();var r=t.length,n=Or?Or(r):new t.constructor(r);return t.copy(n),n}(c,!0)):y?(p=!1,h=wr(c,!0)):h=[]:$t(c)||ee(c)?(h=s,ee(s)?h=$r(s):(!m(s)||o&&k(s))&&(h=function(t){return"function"!=typeof t.constructor||Tt(t)?{}:Er(Et(t))}(c))):p=!1}p&&(a.set(c,h),i(h,c,o,u,a),a.delete(c)),gr(t,n,h)}}function Mr(t,e,r,n,o){t!==e&&dr(e,function(i,u){if(m(i))o||(o=new ye),Cr(t,e,u,r,Mr,n,o);else{var a=n?n(kr(t,u),i,u+"",t,e,o):void 0;void 0===a&&(a=i),gr(t,u,a)}},Pr)}var Tr=Math.max;var Fr=br?function(t,e){return br(t,"toString",{configurable:!0,enumerable:!1,value:(r=e,function(){return r}),writable:!0});var r}:pr,Wr=800,Dr=16,Rr=Date.now;var Br=function(t){var e=0,r=0;return function(){var n=Rr(),o=Dr-(n-r);if(r=n,o>0){if(++e>=Wr)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(Fr);function Ir(t,e){return Br(function(t,e,r){return e=Tr(void 0===e?t.length-1:e,0),function(){for(var n=arguments,o=-1,i=Tr(n.length-e,0),u=Array(i);++o<i;)u[o]=n[e+o];o=-1;for(var a=Array(e+1);++o<e;)a[o]=n[o];return a[e]=r(u),function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}(t,this,a)}}(t,e,pr),t+"")}var Nr;Nr=function(t,e,r){Mr(t,e,r)},Ir(function(t,e){var r=-1,n=e.length,o=n>1?e[n-1]:void 0,i=n>2?e[2]:void 0;for(o=Nr.length>3&&"function"==typeof o?(n--,o):void 0,i&&function(t,e,r){if(!m(r))return!1;var n=typeof e;return!!("number"==n?oe(r)&&Ye(e,r.length):"string"==n&&e in r)&&V(r[e],t)}(e[0],e[1],i)&&(o=n<3?void 0:o,n=1),t=Object(t);++r<n;){var u=e[r];u&&Nr(t,u,r,o)}return t});function Ur(t,e,r){return null==t?t:function(t,e,r,n){if(!m(t))return t;for(var o=-1,i=(e=lt(e,t)).length,u=i-1,a=t;null!=a&&++o<i;){var s=pt(e[o]),c=r;if(o!=u){var f=a[s];void 0===(c=n?n(f,s,a):void 0)&&(c=m(f)?f:Ye(e[o+1])?[]:{})}zr(a,s,c),a=a[s]}return t}(t,e,r)}const Lr=Function("return this")(),Gr=Symbol("hidden"),Vr=t=>!m(t)||(Yr=t,!0===Yr||!1===Yr||b(Yr)&&d(Yr)==dt)||function(t){return"number"==typeof t||b(t)&&d(t)==sr}(t)||wt(t)||Ct(t)||lr(t)||function(t){return"string"==typeof t||!r(t)&&b(t)&&d(t)==hr}(t);var Yr;const Kr=(t,e,r)=>{const n={},o={},i=new WeakMap,u=(t,e,r)=>t===e?null:Vr(t)||Vr(e)?ar(t,e)?null:[t,e]:(Object.entries(t).forEach(([t,a])=>{const s=r?`${r}.${t}`:t;if(m(a)){if(s.startsWith(i.get(a)))return;i.set(a,s)}o[s]=!0;const c=u(a,e[t],s);c&&(n[s]=c)}),void Object.entries(e).forEach(([t,e])=>{const a=r?`${r}.${t}`:t;if(m(e)){if(a.startsWith(i.get(e)))return;i.set(e,a)}if(o[a])return;o[a]=!0;const s=u(void 0,e,a);s&&(n[a]=s)})),a=u(t,e,r);return a?r?{[r]:a}:a:Object.keys(n).length>0?n:null};Kr.isNop=(t=>de(t)||void 0===t[0]&&void 0===t[1]),Kr.isCreate=(t=>void 0===t[0]&&void 0!==t[1]),Kr.isUpdate=(t=>void 0!==t[0]&&void 0!==t[1]),Kr.isRemove=(t=>void 0!==t[0]&&void 0===t[1]);const Qr=(t,e)=>{if(de(t)&&de(e))return null;const r=Kr.isNop,n=t||{},o=e||{},i={},u={};return Object.entries(n).forEach(([t,e])=>{u[t]=!0;const n=o[t],a=r(e),s=r(n);if(a&&s);else if(a)i[t]=n;else if(s)i[t]=e;else{const o=[e[0],n[1]];r(o)||(i[t]=o)}}),Object.entries(o).forEach(([t,e])=>{r(e)||u[t]||(i[t]=e)}),Object.keys(i).length>0?i:null};class Zr{constructor(t){this[Gr]={changes:null,handlers:{}},this.set(t,!1),this.init(),this.render()}init(){return this.trigger("init")}render(t){return t?this.trigger("render"):this}set(t,e){const r=this[Gr],n={};return Object.entries(t||{}).forEach(([t,e])=>{const r=vt(this,t);ar(r,e)||(Object.assign(n,Kr(r,e,t)),Ur(this,t,k(e)?e.bind(this):e))}),r.changes=n,(!0===e||!1!==e&&Object.keys(n).length)&&(this.render(n),this.trigger("change",{changes:n})),this}on(t,e){const r=this[Gr].handlers;return t.split(",").forEach(t=>{r[t]||(r[t]=[]),r[t].push(e)}),this}off(t,e){const r=this[Gr].handlers;return(t&&t.split(",")||Object.keys(r)).forEach(t=>{r[t]=e&&r[t]?r[t].filter(t=>t!==e):[]}),this}trigger(t,e){return t.split(",").forEach(t=>{let r=this[Gr].handlers[t]||[];const n={type:t,target:this,data:e||{}};r.forEach(t=>t(n)),"*"!==t&&(r=this[Gr].handlers["*"]||[]).forEach(t=>t.call(this,n))}),this}invoke(t,e,...r){return t.prototype[e].apply(this,r)}}class Hr{constructor(t){this.queue=[],this.set(t||[])}get length(){return this.queue.length-this.offset}isEmpty(){return 0===this.queue.length}add(...t){return this.queue.push(...t),this}peek(){return this.queue.length>0?this.queue[this.offset]:void 0}get(){if(0===this.queue.length)return;const t=this.queue[this.offset];return 2*++this.offset>=this.queue.length&&(this.queue=this.queue.slice(this.offset),this.offset=0),t}set(t){return this.queue.splice(0,this.queue.length,...t),this.offset=0,this}}const Jr=Lr[["requestAnimationFrame","setImmediate","setTimeout"].find(t=>t in Lr)].bind(Lr);class Xr extends Zr{constructor(t){super(Object.assign({data:[],views:[],config:{}},t))}init(){return this.config=Object.assign({asyncRender:!0,showWarning:!0,largeChange:1e3,drainGrowth:4,drainMethod:Jr},this.config),this.drain=this.drain.bind(this),Object.assign(this[Gr],{diff:null,queue:new Hr,drain_count:0}),this.render(Kr([],this.data,"data")),this.invoke(Zr,"init")}static KEY_BY_ID(t,e){return t&&t.id&&this.views.find(e=>e&&e.id===t.id)||null}key(t,e){return this.views[e]||null}create(t,e){const r=this.update({},t,e);return this.views[e]=r,this.trigger("create",{view:r,model:t,index:e}),r}update(t,e,r){return Object.assign(t,e),this.trigger("update",{view:t,model:e,index:r}),t}remove(t,e){return this.views[e]=void 0,this.trigger("remove",{view:t,index:e}),t}render(t){const e=this[Gr],r=this.config;if("number"==typeof t){const r=t,n=e.diff[r];if(e.diff[r]=void 0,!n)return this;if(Kr.isCreate(n)){const t=this.data[r];this.create(t,r)}else if(Kr.isRemove(n)){const t=n[0],e=this.key(t,r);this.remove(e,r)}else{if(!Kr.isUpdate(n))throw new Error(`unknown diff type: ${n}`);{const t=this.data[r],e=this.key(t,r);this.update(e,t,r)}}return this}if(!t)return this;const n={};Object.entries(t).forEach(([t,e])=>{const r=t.split("."),o=r[1];"data"===r[0]&&r.length>=2&&!n[o]&&(n[o]=r.length>2?["dummy",this.data[o]]:e)}),e.diff=Qr(e.diff,n)||{};const o=e.queue.set(Object.keys(e.diff).map(t=>parseInt(t,10)).sort((t,e)=>t>e));if(r.asyncRender&&o.length>r.largeChange)r.showWarning&&0===e.drain_count&&console.log("WARNING: async render"),e.drain_count+=1,this.drain();else{for(;!o.isEmpty();)this.render(o.get());this.views=this.views.filter(t=>void 0!==t),this.trigger("render")}return this}drain(){const t=this[Gr],e=t.queue;if(t.drain_count-=1,e.isEmpty())return this;if(this.render(e.get()),e.isEmpty())this.views=this.views.filter(t=>void 0!==t),this.trigger("render");else for(let e=0;e<this.config.drainGrowth;e+=1)t.drain_count+=1,this.config.drainMethod(this.drain,0);return this}}function tn(t){return t?Ct(t)?t.parentElement.removeChild(t):t.remove():null}const en=e,rn=(t,e)=>{const[r,n]=e.split(/:(.*)/,2);return{fn:n?function(...t){return en.fn[r].bind(this)(n,...t)}:en.fn[r],isClass:r.endsWith("Class"),val:k(t)?t:()=>t}},nn=function(t,e){const r=$t(t)?Object.entries(t).map(([t,e])=>rn(e,t)):[rn(e,t)];return this.each((t,e)=>{const n=en(e),o=e.getAttribute("class");r.forEach(r=>{const i=r.fn.bind(n),u=r.isClass?o:i(),a=r.val.bind(e)(t,u);(r.isClass||u!==a)&&i(a)})})};en&&en.extend&&en.fn&&en.fn.extend({set:nn}),t.version="0.3.2",t.Widget=Zr,t.Group=Xr,t.List=class extends Xr{constructor(t){super(Object.assign({$dom:null,$tmpl:null,selector:"li"},t))}init(){var t,e;return this.$dom&&this.selector&&!this.$tmpl&&(this.$tmpl=tn((t=this.$dom,e=this.selector,Ct(t)?t.querySelector(e):t.find(e).eq(0)))),this.invoke(Xr,"init")}create(t,e){const r=this.update(Ct(n=this.$tmpl)?n.cloneNode(!0):n.clone(),t,e);var n;return function(t,e){Ct(e)?t.appendChild(e):t.append(e)}(this.$dom,r),this.views[e]=r,this.trigger("create",{view:r,model:t,index:e}),r}update(t,e,r){var n,o;return o=e,Ct(n=t)?n.textContent=o:n.text(o),this.trigger("update",{view:t,model:e,index:r}),t}remove(t,e){return tn(t),this.invoke(Xr,"remove",t,e)}},t.Queue=Hr,t.diff=Kr,t.merge=Qr,Object.defineProperty(t,"__esModule",{value:!0}),t._build="2018-07-04T01:39:46.480Z"});
//# sourceMappingURL=duil.min.js.map
